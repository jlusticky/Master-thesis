%=========================================================================
% (c) 2014, 2015 Josef Lusticky

\section{Software settings}\label{sec:analysis-settings}
The CentOS 7 operating system features various components that influence forwarding performance.
To measure a pure routing performance of the Linux kernel,
the Netfilter and SELinux components should be disabled.
If disabling the netfilter is not appropriate, the iptables utility must be used to configure netfilter to allow forwarding,
because the default rules do not allow packet forwarding.
SELinux in the CentOS~7 operating system uses enforcing policy by default.
Similarly to netfilter, the SELinux component should be disabled to prevent performance decrease.
Influence of both the components on forwarding performance can be measured.

The Linux kernel features dynamic CPU frequency scaling.
The CPUFreq governors are policies that decide what frequency should be used.
The CPUfreq governor {\it{performance}} should be used during the measurements, as it sets the CPU statically to the
highest frequency avaliable~\cite{cpufreq-governors}. %, which is 2.6~GHz in case of Intel Xeon E5-2630 v2.

Packet processing by the Linux kernel can be configured in different ways.
To change the Linux kernel compile-time configuration, the kernel must be recompiled.
The CentOS~7 kernel provides a fair amount of features that could break existing setups when disabled.
The default kernel compile-time configuration does not have to provide the best routing performance,
however, it is usually used in most scenarious and hence its benchmark results are of interests for most people.

When the Linux kernel is compiled with support for symmetric multiprocessing
using the CONFIG\_SMP option and runs on a multiprocessor system, the code for receiving and
transmitting packets takes full advantage of that.
Every modern GNU/Linux distribution compiled for the AMD64 architecture has the option enabled,
including the CentOS~7~\cite{understanding-internals}.

Advanced features configured during compile-time of the Linux kernel introduce
just a negligible overhead when they are not used.
For example, the MULTIPLE\_IP\_TABLES support is enabled in the CentOS 7 distribution kernel, however,
since the measurements presented in this thesis use no policy routing,
the FIB lookup principle described in section~\ref{sec:linux-routing} is still performed.

Apart from compile-time options, the Linux kernel configuration can be changed during run-time.
The proc and sys filesystems provide access to the kernel variables that influence packet processing.
Tuning of these variables can provide significant amount of routing performance improvement when configured properly.

\input{analysis/settings-procfs.tex}

\input{analysis/settings-sysfs.tex}

\input{analysis/settings-ethtool.tex}

%Note that ip route show displays the main table.
%For displaying the local table, you should run ip route show table local~\cite{linux-kernel-networking}.
